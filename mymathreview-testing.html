<!--automated tests for MyMathReview, html file meant to run in browser-->

<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/qunit/2.0.1/qunit.min.js'></script>



<script>
    //JSON object of topics and flags for testing
    //    TODO: finish writing this for data/stat/prob since i know there are bugs that is a good test group

    /*Index explainer: "loads_correctly" is a flag for testing that the question loads in its expected place in order, "completed" is a flag for this question has been tested, "initial_scores" is a set in order of (mastered, unmastered) before the question is executed, "completed_scores" is a set in order of (mastered, unmastered) after the question has been tested*/

    //    extension: can reassign this.topics to pull from python/db

    this.topics = {
        "The Pythagorean Theorem": {
            "qID": "",
            "loads_correctly": "",
            "initial_scores": "",
            "completed": "",
            "completed_scores": ""
        },
        "Finding Missing Sides Using the Pythagorean Theorem": {
            "qID": "",
            "loads_correctly": "",
            "initial_scores": "",
            "completed": "",
            "completed_scores": ""
        },
        "Evaluating Expressions Using Substitution": {
            "qID": "",
            "loads_correctly": "",
            "initial_scores": "",
            "completed": "",
            "completed_scores": ""
        },
        "Solving Simple Radical Equations": {
            "qID": "",
            "loads_correctly": "",
            "initial_scores": "",
            "completed": "",
            "completed_scores": ""
        }
    }

    //<!--TEST to ensure the Topics are loading in order without skipping-->
    Qunit.test(function (topicsTest) {

        $.each(this.topics, function (idx, topic) {
            //<!--    we capture the first instance of an incomplete topic and compare against HTML-->
            if (topic.loads_correctly !== 0 && topic.completed !== 1 && $('.circle-text').innerHTML == topic) {
                topic.loads_correctly = 1;
                break;
            }
        });
        //<!--extend to store in mysql db-->
        console.log(topics);
    });


    //<!--TEST that the question loads correctly-->
    //<!--    assert topic.qID == part of the image name string because that is only location of qID in elements-->

    Qunit.log(function (expectedQuestionTest) {
        var current_topic;

        $.each(this.topics, function (idx, topic) {
            console.log(topic);
            if (topic.complete !== 1) {
                current_topic = topic;
                break;
            }
        });

        //        GOAL: compare the id on the image against the current_topic
        QUnit.test("a test", function (assert) {
            //    assert.equal(actual, expected, message)
            assert.equal(long selector to img with src.contains(topic.qID), topic, "String '1' and number 1 have the same value");
        });
        //        TODO: this selector is broken
        var has_expected_qID = $('.svg-container').children().getAttribute('src').contains(current_topic.qID);

        if (has_expected_qID) {
            console.log('correct question  ' + current_topic.qID);
            this.topics.current_topic.loads_correctly = "1";
        }
    });

    Qunit.test(function (login) {
        $(".ui-btn-hidden").click();
    });


    //these have been tested and work
    Qunit.test(function (automatedSteps) {
        var topics_remaining = [];
        //      first generate sub object of shorter length to optimize searching
        $.each(this.topics, function (idx, topic) {
            if (topic.completed == "1") {
                topics_remaining.push(topic);
            }
        });
        var url = window.location();

         (the count of the length of the standards in the spreadsheet) {
            if (url.contains("dashboard")) {
                //click the 'practice problems' button


                //the last thing we do before entering the exam
                $(".ui-btn-text").click();
            }
        if (url.contains("topics"))
            if ($(".e-answer-select")
                //select option a
                $(".e-answer-select")[0].click();

                //submit
                $(".e-answer-save").click();

            )

            //need to set a timeout, or wait on pageload before executing the next trigger since a new page loads between these events

            //next
                $(".e-next").click();
        }

    });

    //    SCRIPT checking the dashboard scores for every completed topic 
    //    TEST to verify the correct points are being added
</script>